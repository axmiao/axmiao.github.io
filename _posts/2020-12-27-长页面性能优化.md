---
layout: post
title: "面试准备（3）-- 长页面性能优化"
subtitle: "关于性能优化"
date:   2020-12-27 22:57:00 +0800
author: "axmiao"
header-img: "img/post-bg-20201215.png"
categories: jekyll update
catalog: true
tags: 
    - 面试题
    - 性能优化
---

此篇为面试总结的第三篇，之前说好每周一篇，这一周实在是拖延，不得不赶在周日半夜十点补文，说起来实在是惭愧。希望能下周提前完成！

最近北京开始了新一波疫情，且这两的发展趋势离我家越来越近，所以元旦假期之前我要在家休年假，元旦之后的第一周我也要居家隔离，homeOffice。这样就有了充足的时间准备下一篇blog了。不过小伙伴们还是要注意防护，冬天到了，细菌的存活度变高了，大家勤洗手勤通风，不聚集，注意安全。

这一篇的主题是长页面的性能优化。个人感觉这个主题考察的点比较综合。不单单是对某一种语言的熟练，更要从全局的角度来出发看问题。

长页面一般意味着dom树长，资源多，事件多。那么可以做一些针对性的调整。

## 1. dom树长

当页面的dom很长时，加载页面就需要很长时间来渲染dom树，此时我们可以删掉多余的注释，用一些html压缩库来压缩html文件，尽量减少html中的无用代码。

## 2. 请求资源多

当页面很长时，通常意味着需要展示跟多的信息，其中包括更多的图片，文字之类的资源，那么我们可以通过懒加载的方式，在所需资源即将出现在视窗内的时候再去请求，这样虽然资源总数没变，但页面加载时的并发请求数量将会减少，也会使得页面加载变快。

## 3.事件多

当页面上dom元素有很多时，难免会造成绑定在元素上的事件很多，这样既使得内存占用变高也会注册很多功能重叠的事件。针对这个情况，我们可以选择事件委托的方式，将绑定在每一个元素上的事件统一委托给父级元素，由父级元素统一监听触法。

## 4.雪碧图的使用

关于雪碧图的使用，即使不是在长页面的优化中也常常用到，它的原理是将很多icon，小图标，背景图片中的一条合成到一张大图上，这样可以通过合并图片使请求图片的数量减少，以达到加速页面加载的目的。

## 5.对事件的节流和防抖

防抖一般就是利用计时器，达到在指定时间长度内无新事件触发情况下执行最后一次。

节流一般也要指定一个时间长度，在一个事件连续触发的情况下，事件每隔固定时间执行一次。

## 6.减少页面重绘及回流

这一点在普通页面优化中也需要考虑。

当页面中元素样式的改变并不影响它在文档流中的位置时（例如：color、background-color、visibility 等），浏览器会将新样式赋予给元素并重新绘制它，这个过程称为重绘。

当 Render Tree 中部分或全部元素的尺寸、结构、或某些属性发生改变时，浏览器重新渲染部分或全部文档的过程称为回流。

明显回流的消耗会远大于重绘,一下改变会触发回流，当减少下面这些操作的时候也就是在减少回流发生，达到优化页面的效果。

> * 页面首次渲染
> * 浏览器窗口大小发生改变
> * 元素尺寸或位置发生改变元素内容变化（文字数量或图片大小等等）
> * 元素字体大小变化
> * 添加或者删除可见的 DOM 元素
> * 激活 CSS 伪类（例如:hover）
> * 查询某些属性或调用某些方法
> * 一些常用且会导致回流的属性和方法
> clientWidth、clientHeight、clientTop、clientLeftoffsetWidth、offsetHeight、offsetTop、offsetLeftscrollWidth、scrollHeight、scrollTop、scrollLeftscrollIntoView()、scrollIntoViewIfNeeded()、getComputedStyle()、getBoundingClientRect()、scrollTo()

上面这些就是暂时能想到的对于长页面优化的一些点，之后如果能想到新的点，会及时更新～
